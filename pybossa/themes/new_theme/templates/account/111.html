{% extends "base.html" %}

{% block content %}
{% from "_formhelpers.html" import render_form %}
<section class="account register">
    <div class="container">
        <div class="row">
            <div class="col-md-offset-2 col-md-8">
                <h1>{{ _('Create an account') }}</h1>
                <div id="ageCheck" class="form-inline">
                    <div class="form-group">
                        <p>{{_('To create an account you must be 16+ years old. Please enter your date of birth')}}</p>
                        <select class="form-control" id="year">
							<option value="2010" selected>2010</option>
							<option value="2009" >2009</option>
							<option value="2008" >2008</option>
							<option value="2007" >2007</option>
							<option value="2006" >2006</option>
							<option value="2005" >2005</option>
							<option value="2004" >2004</option>
							<option value="2003" >2003</option>
							<option value="2002" >2002</option>
							<option value="2001" >2001</option>
							<option value="2000" >2000</option>
							<option value="1999" >1999</option>
							<option value="1998" >1998</option>
							<option value="1997" >1997</option>
							<option value="1996" >1996</option>
							<option value="1995" >1995</option>
							<option value="1994" >1994</option>
							<option value="1993" >1993</option>
							<option value="1992" >1992</option>
							<option value="1991" >1991</option>
							<option value="1990" >1990</option>
							<option value="1989" >1989</option>
							<option value="1988" >1988</option>
							<option value="1987" >1987</option>
							<option value="1986" >1986</option>
							<option value="1985" >1985</option>
							<option value="1984" >1984</option>
							<option value="1983" >1983</option>
							<option value="1982" >1982</option>
							<option value="1981" >1981</option>
							<option value="1980" >1980</option>
							<option value="1979" >1979</option>
							<option value="1978" >1978</option>
							<option value="1977" >1977</option>
							<option value="1976" >1976</option>
							<option value="1975" >1975</option>
							<option value="1974" >1974</option>
							<option value="1973" >1973</option>
							<option value="1972" >1972</option>
							<option value="1971" >1971</option>
							<option value="1970" >1970</option>
							<option value="1969" >1969</option>
							<option value="1968" >1968</option>
							<option value="1967" >1967</option>
							<option value="1966" >1966</option>
							<option value="1965" >1965</option>
							<option value="1964" >1964</option>
							<option value="1963" >1963</option>
							<option value="1962" >1962</option>
							<option value="1961" >1961</option>
							<option value="1960" >1960</option>
							<option value="1959" >1959</option>
							<option value="1958" >1958</option>
							<option value="1957" >1957</option>
							<option value="1956" >1956</option>
							<option value="1955" >1955</option>
							<option value="1954" >1954</option>
							<option value="1953" >1953</option>
							<option value="1952" >1952</option>
							<option value="1951" >1951</option>
							<option value="1950" >1950</option>
						</select> 년
                        <select class="form-control" id="month">
		                    <option value="1" selected>1</option>
	                        <option value="2">2</option>
							<option value="2" >2</option>
							<option value="3" >3</option>
							<option value="4" >4</option>
							<option value="5" >6</option>
							<option value="7" >7</option>
							<option value="8" >8</option>
							<option value="9" >9</option>
							<option value="10" >10</option>
							<option value="11" >11</option>
							<option value="12" >12</option>
	                    </select> 월
                        <select class="form-control" id="day">
							<option value="1" selected>1</option>
							<option value="2" >2</option>
							<option value="3" >3</option>
							<option value="4" >4</option>
							<option value="5" >5</option>
							<option value="6" >6</option>
							<option value="7" >7</option>
							<option value="8" >8</option>
							<option value="9" >9</option>
							<option value="10" >10</option>
							<option value="11" >11</option>
							<option value="12" >12</option>
							<option value="13" >13</option>
							<option value="14" >14</option>
							<option value="15" >16</option>
							<option value="17" >17</option>
							<option value="18" >18</option>
							<option value="19" >19</option>
							<option value="20" >20</option>
							<option value="21" >21</option>
							<option value="22" >22</option>
							<option value="23" >23</option>
							<option value="24" >24</option>
							<option value="25" >25</option>
							<option value="26" >26</option>
							<option value="27" >27</option>
							<option value="28" >28</option>
							<option value="29" >29</option>
							<option value="30" >30</option>
							<option value="31" >31</option>
						</select> 일
						<div class="form-group" style = "float: right;">
							<select class="form-control" id="sex">
								<option>성별</option>
								<option>남성</option>
								<option>여성</option>
							</select>
						</div>
					</div>
					<p>
                    <button onclick="checkAge()" style="margin-top:15px;" class="btn btn-primary">Check</button>
					</p>
                </div>

                {{ render_form(form, form_id="register", action_url=url_for('account.register'), btn_class="btn btn-primary btn-block" )}}

                <!-- <p class="text-center text-sm" style="margin-top:5px;">
                <span class="label label-warning"><i class="fa fa-bullhorn"></i> {{ _('Note') }}</span> 
                {{ _('By click the') }} 
                <strong>{{ _('Create account button') }}
                </strong>{{ _('below you are agreeing to the') }}
                <a target="blank" href={{terms_of_use | safe}}>{{ _('terms of use') }} </a>{{ _('and') }} 
                <a href={{data_use | safe}}>{{ _('data') }}</a>.
				</p> -->
            </div>
        </div>
    </div>
</section>
<script src="{{url_for('static', filename='js/forms.js')}}" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.1/moment.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.13.2/tingle.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.13.2/tingle.min.js"></script>
<script>
var modal = new tingle.modal({
    footer: true,
    stickyFooter: false,
    closeMethods: ['overlay', 'button', 'escape'],
    closeLabel: "Close",
    cssClass: ['custom-class-1', 'custom-class-2'],
    onOpen: function() {
        console.log('modal open');
    },
    onClose: function() {
        console.log('modal closed');
        window.location.href = '/';
    },
    beforeClose: function() {
        // here's goes some logic
        // e.g. save content before closing the modal
        return true; // close the modal
        return false; // nothing happens
    }
});

// set content
modal.setContent("<h1>You must be 16+ years old to create an account</h1> <p>{{aaa}}</p> <p>You cannot create an account in this server unless you are 16+ years old. However, you can still participate as an anonymous user as you don't need an account for doing so.</p>");

// add a button
modal.addFooterBtn('OK', 'tingle-btn tingle-btn--primary', function() {
    // here goes some logic
    modal.close();
});

// add another button
// modal.addFooterBtn('Dangerous action !', 'tingle-btn tingle-btn--danger', function() {
//     // here goes some logic
//     modal.close();
// });

function checkAge () {
    var day = document.getElementById('day').value;
    var month = document.getElementById('month').value;
    var year = document.getElementById('year').value;
    var birthday = moment(new Date(year, month, day));
    var yearsOld = moment().diff(birthday, 'year');
    console.log(yearsOld)

    if (!year){
        modal.open();
    } else if (yearsOld >= 16) {
        document.getElementById('register').style.display='block';
        document.getElementById('ageCheck').style.display='none';
        localStorage.setItem('ageCheck', true);
    } else {
        modal.open();
    }
}
</script>
<style>
#register {
    display: none;
}
</style>
{% endblock %}
